<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>servio: Servio</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">servio
   </div>
   <div id="projectbrief">open source servomotor firmware</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Servio </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> <a href="https://github.com/emsro/servio/actions/workflows/tests.yml"><img src="https://github.com/emsro/servio/actions/workflows/tests.yml/badge.svg" alt="Tests" style="pointer-events: none;" class="inline"/></a> <a href="https://raw.githubusercontent.com/nlohmann/json/master/LICENSE.MIT"><img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="GitHub license" style="pointer-events: none;" class="inline"/></a></p>
<p>Open firmware for DC servomotors written in C++20. The FW uses closed control loops, serial communication, and has automatized testing infrastructure. More details in <a href="https://emsro.github.io/servio/index.html">Documentation</a></p>
<h1><a class="anchor" id="autotoc_md1"></a>
Disclaimer</h1>
<p>The project is in development state, beware that the code still might have problematic bugs.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Dependencies</h1>
<p>We maintain <code>Dockerfile</code> with installed dependencies for CI. Use that to install adequate packages in your system, or you can just use that docker file.</p>
<p><code>Dockerfile</code> is stored in this repository: <a href="https://github.com/emsro/build-env">https://github.com/emsro/build-env</a></p>
<h1><a class="anchor" id="autotoc_md3"></a>
Build</h1>
<p><code>cmake</code> is used as build system, however the setup is not trivial. We can't compile code for multiple platforms at the same time, hence the design is to use cmake multiple times, once for each platform. If you don't care about the details, you can just use <code>make configure</code> followed by <code>make build</code> in the root folder of the repository, which will correctly build for all platforms.</p>
<p>We use cmake presets with definitions of the builds for each platform. The presets contain the name of the platform in their name, so <code>stm32h5_debug_build</code> represents build for STM32H5, and it is used as so: </p><div class="fragment"><div class="line">cmake --preset &quot;stm32h5_debug_cfg&quot;</div>
<div class="line">cmake --build --preset &quot;stm32h5_debug_build&quot;</div>
</div><!-- fragment --><p> <code>host_debug_build</code> represents build of stuff used on the host, and is used as so: </p><div class="fragment"><div class="line">cmake --preset &quot;host_debug_cfg&quot;</div>
<div class="line">cmake --build --preset &quot;host_debug_build&quot;</div>
</div><!-- fragment --><p>Under the hood, the presets use <code>SERVIO_PLATFORM</code> to setup which platform should be currently build and the cmake files in the project react accordingly.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Flashing</h1>
<p>To flash the firmware, find a openocd file for your platform (<code>src/plt/stm32g4/openocd.cfg</code> for STM32G4) and use it with openocd to flash a firmware file into the device. See <code>make flash</code> target for inspiration.</p>
<p>The pattern for naming the firmware is <code>&lt;board_name&gt;_fw.elf</code> and can be found in <code>build/&lt;platform_name&gt;</code>.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Usage</h1>
<p>After the firmware was fleshed, the servo should communicate over UART via the interface connector. The communication protocol is protobuf wrapped in COBS (Consistent Overhead Byte Stuffing ) for framing.</p>
<p>All our protobuf messages are in single file: <a href="src/iface/io.protoz">src/iface/io.proto</a> We recommend that you use that file to generate a bindings for your favourite language. All that is necessary is to use the proper protobuf message and wrap it in COBS. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue May 21 2024 05:23:08 for servio by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
